<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Error Monitor SDK - åŠŸèƒ½æµ‹è¯•é¡µé¢</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    h1 {
      color: white;
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .card h2 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 1.3em;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 10px;
    }

    .button-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    button:active {
      transform: translateY(0);
    }

    button.secondary {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    button.success {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    button.warning {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    }

    .log-panel {
      background: #1e1e1e;
      color: #00ff00;
      padding: 20px;
      border-radius: 12px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      max-height: 400px;
      overflow-y: auto;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
    }

    .log-entry {
      margin-bottom: 8px;
      padding: 5px;
      border-left: 3px solid #00ff00;
      padding-left: 10px;
    }

    .log-entry.error {
      color: #ff6b6b;
      border-left-color: #ff6b6b;
    }

    .log-entry.warn {
      color: #ffd93d;
      border-left-color: #ffd93d;
    }

    .log-entry.info {
      color: #6bcbff;
      border-left-color: #6bcbff;
    }

    .metrics-panel {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
    }

    .metric-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #e0e0e0;
    }

    .metric-item:last-child {
      border-bottom: none;
    }

    .metric-label {
      font-weight: 600;
      color: #555;
    }

    .metric-value {
      color: #667eea;
      font-weight: 700;
    }

    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      margin-left: 10px;
    }

    .status-badge.healthy {
      background: #d4edda;
      color: #155724;
    }

    .status-badge.unhealthy {
      background: #f8d7da;
      color: #721c24;
    }

    .clear-btn {
      background: #6c757d;
      margin-top: 10px;
    }

    #config-display {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 6px;
      font-size: 12px;
      margin-bottom: 15px;
      color: #666;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸš€ Error Monitor SDK - åŠŸèƒ½æµ‹è¯•</h1>

    <div class="grid">
      <!-- é”™è¯¯æ•è·æµ‹è¯• -->
      <div class="card">
        <h2>âŒ é”™è¯¯æ•è·æµ‹è¯•</h2>
        <div class="button-group">
          <button onclick="testJSError()">è§¦å‘ JS é”™è¯¯</button>
          <button onclick="testPromiseError()" class="secondary">è§¦å‘ Promise é”™è¯¯</button>
          <button onclick="testNetworkError()" class="warning">è§¦å‘ç½‘ç»œé”™è¯¯</button>
          <button onclick="testManualError()" class="success">æ‰‹åŠ¨ä¸ŠæŠ¥é”™è¯¯</button>
          <button onclick="testManualMessage()">æ‰‹åŠ¨ä¸ŠæŠ¥æ¶ˆæ¯</button>
        </div>
      </div>

      <!-- æ€§èƒ½ç›‘æ§æµ‹è¯• -->
      <div class="card">
        <h2>âš¡ æ€§èƒ½ç›‘æ§</h2>
        <div class="button-group">
          <button onclick="showPerformanceMetrics()">æ˜¾ç¤ºæ€§èƒ½æŒ‡æ ‡</button>
          <button onclick="showPerformanceSummary()" class="secondary">æ€§èƒ½æ‘˜è¦</button>
          <button onclick="checkPerformanceHealth()" class="success">å¥åº·æ£€æŸ¥</button>
          <button onclick="testBatchProcessing()" class="warning">æµ‹è¯•æ‰¹é‡å¤„ç† (5ä¸ªé”™è¯¯)</button>
        </div>
        <div class="metrics-panel" id="performance-metrics"></div>
      </div>

      <!-- é¢åŒ…å±‘æµ‹è¯• -->
      <div class="card">
        <h2>ğŸ é¢åŒ…å±‘æµ‹è¯•</h2>
        <div class="button-group">
          <button onclick="addNavigationCrumb()">æ·»åŠ å¯¼èˆªé¢åŒ…å±‘</button>
          <button onclick="addClickCrumb()" class="secondary">æ·»åŠ ç‚¹å‡»é¢åŒ…å±‘</button>
          <button onclick="addCustomCrumb()" class="success">æ·»åŠ è‡ªå®šä¹‰é¢åŒ…å±‘</button>
          <button onclick="addErrorCrumb()" class="warning">æ·»åŠ é”™è¯¯é¢åŒ…å±‘</button>
        </div>
      </div>

      <!-- é…ç½®æµ‹è¯• -->
      <div class="card">
        <h2>âš™ï¸ é…ç½®æµ‹è¯•</h2>
        <div id="config-display"></div>
        <div class="button-group">
          <button onclick="toggleSDK()">åˆ‡æ¢ SDK å¯ç”¨çŠ¶æ€</button>
          <button onclick="updateConfig()" class="secondary">æ›´æ–°é‡‡æ ·ç‡</button>
          <button onclick="setUserInfo()" class="success">è®¾ç½®ç”¨æˆ·ä¿¡æ¯</button>
          <button onclick="testFiltering()" class="warning">æµ‹è¯•é”™è¯¯è¿‡æ»¤</button>
        </div>
      </div>
    </div>

    <!-- æ—¥å¿—é¢æ¿ -->
    <div class="card">
      <h2>
        ğŸ“‹ å®æ—¶æ—¥å¿—
        <span id="status-badge" class="status-badge healthy">SDK è¿è¡Œä¸­</span>
      </h2>
      <div class="log-panel" id="log-panel">
        <div class="log-entry info">[ç³»ç»Ÿ] é¡µé¢åŠ è½½å®Œæˆï¼ŒSDK åˆå§‹åŒ–ä¸­...</div>
      </div>
      <button onclick="clearLogs()" class="clear-btn">æ¸…ç©ºæ—¥å¿—</button>
    </div>
  </div>

  <script src="dist/error-monitor-web.umd.js"></script>
  <script>
    // æ£€æŸ¥SDKæ˜¯å¦åŠ è½½æˆåŠŸ
    if (typeof ErrorMonitorWeb === 'undefined') {
      document.getElementById('log-panel').innerHTML +=
        '<div class="log-entry error">[é”™è¯¯] SDK åŠ è½½å¤±è´¥ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®æ„å»ºé¡¹ç›®</div>';
    }
  </script>
  <script>
    let monitor;
    let errorCount = 0;

    // åˆå§‹åŒ– SDK
    function initSDK() {
      monitor = new ErrorMonitorWeb({
        appId: 'test-app-123',
        dsn: 'http://localhost:3001/api/collect',
        environment: 'development',
        release: '1.0.0',
        debug: true,
        enabled: true,

        // æ‰¹é‡ä¸ŠæŠ¥é…ç½®
        report: {
          delay: 2000,        // 2ç§’åæ‰¹é‡ä¸ŠæŠ¥
          batchSize: 5,       // æ”¶é›†5ä¸ªé”™è¯¯åä¸ŠæŠ¥
          // è‡ªå®šä¹‰ä¸ŠæŠ¥å‡½æ•°
          customReporter: (data) => {
            log('info', 'ğŸ“¤ é”™è¯¯å·²ä¸ŠæŠ¥', {
              type: data.type,
              level: data.level,
              message: data.message.substring(0, 40) + '...',
              eventId: data.eventId.substring(0, 8) + '...'
            });

            // å®é™…å‘é€åˆ°æœåŠ¡å™¨
            fetch('http://localhost:3001/api/collect', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(data)
            }).catch(err => {
              log('error', 'ä¸ŠæŠ¥å¤±è´¥', { error: err.message });
            });
          }
        },

        // é‡‡æ ·é…ç½®
        sampleRate: 1.0,      // 100% é‡‡æ ·
        errorSampleRate: 1.0, // 100% é”™è¯¯é‡‡æ ·

        // è‡ªåŠ¨æ•è·
        autoCapture: {
          js: true,
          promise: true,
          network: true,
          resource: true
        },

        // è¿‡æ»¤é…ç½®
        filter: {
          ignoreErrors: [
            /Script error/i,  // å¿½ç•¥è·¨åŸŸè„šæœ¬é”™è¯¯
            /^Test ignored/i  // å¿½ç•¥ä»¥"Test ignored"å¼€å¤´çš„é”™è¯¯
          ],
          minLevel: 'info'
        }
      });

      // æ·»åŠ æ’ä»¶æ¥ç›‘å¬SDKçš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
      monitor.use({
        name: 'test-logger-plugin',
        version: '1.0.0',

        // åœ¨æ•è·é”™è¯¯ä¹‹å‰
        beforeCapture: (error) => {
          log('info', 'ğŸ¯ æ•è·åˆ°é”™è¯¯', {
            type: error.type,
            message: error.message.substring(0, 40) + (error.message.length > 40 ? '...' : '')
          });
          return error;
        },

        // åœ¨æ•è·é”™è¯¯ä¹‹åã€ä¸ŠæŠ¥ä¹‹å‰
        afterCapture: (report) => {
          log('info', 'âœ… é”™è¯¯æŠ¥å‘Šå·²ç”Ÿæˆ', {
            eventId: report.eventId.substring(0, 8) + '...',
            level: report.level,
            breadcrumbs: report.breadcrumbs.length + ' æ¡',
            url: window.location.href
          });
        },

        // åœ¨ä¸ŠæŠ¥ä¹‹å‰
        beforeReport: (report) => {
          log('info', 'ğŸ“¤ å‡†å¤‡ä¸ŠæŠ¥é”™è¯¯', {
            eventId: report.eventId.substring(0, 8) + '...',
            type: report.type,
            message: report.message.substring(0, 30) + '...'
          });
          return report;
        }
      });

      monitor.init();

      // æ˜¾ç¤ºé…ç½®
      const configDisplay = document.getElementById('config-display');
      configDisplay.innerHTML = `
        <strong>å½“å‰é…ç½®ï¼š</strong><br>
        â€¢ AppID: ${monitor.config.appId}<br>
        â€¢ ç¯å¢ƒ: ${monitor.config.environment || 'N/A'}<br>
        â€¢ æ‰¹é‡å¤§å°: ${monitor.config.report?.batchSize}<br>
        â€¢ ä¸ŠæŠ¥å»¶è¿Ÿ: ${monitor.config.report?.delay}ms<br>
        â€¢ é‡‡æ ·ç‡: ${(monitor.config.sampleRate * 100).toFixed(0)}%<br>
        â€¢ çŠ¶æ€: ${monitor.config.enabled ? 'âœ… å¯ç”¨' : 'âŒ ç¦ç”¨'}
      `;

      log('info', 'SDK åˆå§‹åŒ–æˆåŠŸ', {
        appId: monitor.config.appId,
        batchDelay: monitor.config.report?.delay + 'ms',
        batchSize: monitor.config.report?.batchSize
      });

      // è‡ªåŠ¨æ˜¾ç¤ºæ€§èƒ½æŒ‡æ ‡
      setTimeout(() => {
        showPerformanceMetrics();
      }, 1000);
    }

    // æ—¥å¿—å‡½æ•°
    function log(level, message, data) {
      const logPanel = document.getElementById('log-panel');
      const timestamp = new Date().toLocaleTimeString();
      const dataStr = data ? ` | ${JSON.stringify(data)}` : '';
      const logEntry = document.createElement('div');
      logEntry.className = `log-entry ${level}`;
      logEntry.textContent = `[${timestamp}] [${level.toUpperCase()}] ${message}${dataStr}`;
      logPanel.appendChild(logEntry);
      logPanel.scrollTop = logPanel.scrollHeight;
    }

    function clearLogs() {
      document.getElementById('log-panel').innerHTML = '';
      log('info', 'æ—¥å¿—å·²æ¸…ç©º');
    }

    // æµ‹è¯• JS é”™è¯¯
    function testJSError() {
      errorCount++;
      log('warn', `ğŸ§ª å¼€å§‹æµ‹è¯• JS é”™è¯¯ #${errorCount}`);
      try {
        throw new Error(`æµ‹è¯• JS é”™è¯¯ #${errorCount} - This is a test JavaScript error`);
      } catch (error) {
        log('info', 'ğŸ“ è°ƒç”¨ monitor.captureError()...');
        monitor.captureError(error, {
          level: 'error',
          tags: { test: 'js-error', manual: 'true' },
          extra: { errorCount }
        });
      }
    }

    // æµ‹è¯• Promise é”™è¯¯
    function testPromiseError() {
      errorCount++;
      log('warn', `ğŸ§ª å¼€å§‹æµ‹è¯• Promise é”™è¯¯ #${errorCount}`);
      log('info', 'ğŸ“ åˆ›å»º rejected Promise...');

      Promise.reject(new Error(`æµ‹è¯• Promise é”™è¯¯ #${errorCount} - This is a test promise rejection`))
        .catch(err => {
          log('error', 'Promise è¢« catch äº†ï¼Œä½†å…¨å±€ unhandledrejection å¯èƒ½å·²ç»è§¦å‘', {
            message: err.message
          });
        });
    }

    // æµ‹è¯•ç½‘ç»œé”™è¯¯
    function testNetworkError() {
      errorCount++;
      log('warn', `ğŸ§ª å¼€å§‹æµ‹è¯•ç½‘ç»œé”™è¯¯ #${errorCount}`);
      log('info', 'ğŸ“ å‘èµ·è¯·æ±‚åˆ°æ— æ•ˆåŸŸå...');

      fetch('http://invalid-domain-test-12345.com')
        .then(() => {
          log('info', 'âš ï¸ ç½‘ç»œè¯·æ±‚æ„å¤–æˆåŠŸ');
        })
        .catch(err => {
          log('error', 'âŒ ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼ˆå¯èƒ½è¢« SDK æ•è·ï¼‰', {
            error: err.message
          });
        });
    }

    // æ‰‹åŠ¨ä¸ŠæŠ¥é”™è¯¯
    function testManualError() {
      errorCount++;
      log('warn', `ğŸ§ª æ‰‹åŠ¨ä¸ŠæŠ¥é”™è¯¯ #${errorCount}`);
      log('info', 'ğŸ“ è°ƒç”¨ monitor.capture()...');

      const error = new Error(`æ‰‹åŠ¨ä¸ŠæŠ¥çš„è‡ªå®šä¹‰é”™è¯¯ #${errorCount}`);
      monitor.capture({
        type: 'custom',
        message: error.message,
        stack: error.stack,
        context: {
          action: 'manual-report',
          timestamp: Date.now(),
          errorCount
        }
      }, {
        level: 'error',
        tags: { type: 'manual', source: 'test-page' },
        extra: { testInfo: 'This is a manual error report test' }
      });
    }

    // æ‰‹åŠ¨ä¸ŠæŠ¥æ¶ˆæ¯
    function testManualMessage() {
      errorCount++;
      log('warn', `ğŸ§ª æ‰‹åŠ¨ä¸ŠæŠ¥æ¶ˆæ¯ #${errorCount}`);
      log('info', 'ğŸ“ è°ƒç”¨ monitor.captureMessage()...');

      monitor.captureMessage(
        `è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯ #${errorCount} - Test message for error monitoring`,
        'info',
        {
          tags: { type: 'message', source: 'test-page' },
          extra: { errorCount, timestamp: Date.now() }
        }
      );
    }

    // æ˜¾ç¤ºæ€§èƒ½æŒ‡æ ‡
    function showPerformanceMetrics() {
      const metrics = monitor.getPerformanceMetrics();
      const panel = document.getElementById('performance-metrics');

      let html = '<div class="metric-item"><span class="metric-label">SDK åˆå§‹åŒ–</span>';

      if (metrics.initTime) {
        html += `<span class="metric-value">${metrics.initTime.duration.toFixed(2)} ms</span></div>`;
      } else {
        html += '<span class="metric-value">æš‚æ— æ•°æ®</span></div>';
      }

      if (metrics.errorProcessing) {
        const ep = metrics.errorProcessing;
        html += `
          <div class="metric-item">
            <span class="metric-label">é”™è¯¯å¤„ç†</span>
            <span class="metric-value">${ep.totalErrors} æ¬¡ | å¹³å‡ ${ep.averageProcessingTime.toFixed(2)} ms</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">å¤„ç†æ—¶é—´èŒƒå›´</span>
            <span class="metric-value">${ep.minProcessingTime.toFixed(2)} - ${ep.maxProcessingTime.toFixed(2)} ms</span>
          </div>
        `;
      }

      if (metrics.upload) {
        const up = metrics.upload;
        const successRate = ((up.totalUploads - up.failedUploads) / up.totalUploads * 100).toFixed(1);
        html += `
          <div class="metric-item">
            <span class="metric-label">æ•°æ®ä¸ŠæŠ¥</span>
            <span class="metric-value">${up.totalUploads} æ¬¡ | æˆåŠŸç‡ ${successRate}%</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">ä¸ŠæŠ¥è€—æ—¶</span>
            <span class="metric-value">å¹³å‡ ${up.averageUploadTime.toFixed(2)} ms</span>
          </div>
        `;
      }

      if (metrics.memory) {
        const mem = metrics.memory;
        const usedMB = (mem.usedJSHeapSize / 1024 / 1024).toFixed(2);
        const totalMB = (mem.totalJSHeapSize / 1024 / 1024).toFixed(2);
        html += `
          <div class="metric-item">
            <span class="metric-label">å†…å­˜ä½¿ç”¨</span>
            <span class="metric-value">${usedMB} MB / ${totalMB} MB</span>
          </div>
        `;
      }

      panel.innerHTML = html;
      log('info', 'æ€§èƒ½æŒ‡æ ‡å·²æ›´æ–°');
    }

    // æ˜¾ç¤ºæ€§èƒ½æ‘˜è¦
    function showPerformanceSummary() {
      const summary = monitor.getPerformanceSummary();
      log('info', 'ğŸ“Š æ€§èƒ½æ‘˜è¦', { summary });
      alert('æ€§èƒ½æ‘˜è¦ï¼š\n\n' + summary);
    }

    // æ£€æŸ¥æ€§èƒ½å¥åº·
    function checkPerformanceHealth() {
      const health = monitor.checkPerformanceHealth();
      const badge = document.getElementById('status-badge');

      if (health.healthy) {
        badge.className = 'status-badge healthy';
        badge.textContent = 'âœ… æ€§èƒ½å¥åº·';
        log('info', 'âœ… æ€§èƒ½å¥åº·æ£€æŸ¥é€šè¿‡');
      } else {
        badge.className = 'status-badge unhealthy';
        badge.textContent = 'âš ï¸ æ€§èƒ½è­¦å‘Š';
        log('warn', 'âš ï¸ æ€§èƒ½é—®é¢˜', { issues: health.issues });
        alert('æ€§èƒ½è­¦å‘Šï¼š\n\n' + health.issues.join('\n'));
      }
    }

    // æµ‹è¯•æ‰¹é‡å¤„ç†
    function testBatchProcessing() {
      log('warn', 'ğŸ”„ å¼€å§‹æ‰¹é‡å¤„ç†æµ‹è¯• - å°†è§¦å‘ 5 ä¸ªé”™è¯¯');
      log('info', `ğŸ“Š æ‰¹é‡é…ç½®ï¼šbatchSize=${monitor.config.report?.batchSize}, delay=${monitor.config.report?.delay}ms`);

      for (let i = 1; i <= 5; i++) {
        setTimeout(() => {
          log('info', `ğŸ“ è§¦å‘é”™è¯¯ #${i}/${5}...`);
          monitor.capture({
            type: 'custom',
            message: `æ‰¹é‡æµ‹è¯•é”™è¯¯ #${i} - Batch Test Error`,
            context: {
              batchIndex: i,
              totalInBatch: 5,
              timestamp: Date.now()
            }
          });
        }, i * 200);
      }

      log('info', `â³ æ‰€æœ‰é”™è¯¯å·²è§¦å‘ï¼Œå°†åœ¨ ${monitor.config.report?.delay}ms åæ‰¹é‡ä¸ŠæŠ¥`);
    }

    // æ·»åŠ å¯¼èˆªé¢åŒ…å±‘
    function addNavigationCrumb() {
      monitor.addBreadcrumb({
        type: 'navigation',
        message: 'å¯¼èˆªåˆ°æµ‹è¯•é¡µé¢',
        data: { from: 'home', to: 'test' }
      });
      log('info', 'ğŸ å¯¼èˆªé¢åŒ…å±‘å·²æ·»åŠ ');
    }

    // æ·»åŠ ç‚¹å‡»é¢åŒ…å±‘
    function addClickCrumb() {
      monitor.addBreadcrumb({
        type: 'ui',
        message: 'ç”¨æˆ·ç‚¹å‡»æŒ‰é’®',
        data: { element: 'test-button', action: 'click' }
      });
      log('info', 'ğŸ ç‚¹å‡»é¢åŒ…å±‘å·²æ·»åŠ ');
    }

    // æ·»åŠ è‡ªå®šä¹‰é¢åŒ…å±‘
    function addCustomCrumb() {
      monitor.addBreadcrumb({
        type: 'custom',
        message: 'è‡ªå®šä¹‰äº‹ä»¶',
        data: { userId: '123', action: 'test' }
      });
      log('info', 'ğŸ è‡ªå®šä¹‰é¢åŒ…å±‘å·²æ·»åŠ ');
    }

    // æ·»åŠ é”™è¯¯é¢åŒ…å±‘
    function addErrorCrumb() {
      monitor.addBreadcrumb({
        type: 'error',
        message: 'å‘ç”Ÿè­¦å‘Š',
        data: { code: 'WARN-001', severity: 'medium' }
      });
      log('info', 'ğŸ é”™è¯¯é¢åŒ…å±‘å·²æ·»åŠ ');
    }

    // åˆ‡æ¢ SDK å¯ç”¨çŠ¶æ€
    function toggleSDK() {
      if (monitor.config.enabled) {
        monitor.disable();
        log('warn', 'ğŸ”´ SDK å·²ç¦ç”¨');
        document.getElementById('status-badge').className = 'status-badge unhealthy';
        document.getElementById('status-badge').textContent = 'SDK å·²ç¦ç”¨';
      } else {
        monitor.enable();
        log('info', 'ğŸŸ¢ SDK å·²å¯ç”¨');
        document.getElementById('status-badge').className = 'status-badge healthy';
        document.getElementById('status-badge').textContent = 'SDK è¿è¡Œä¸­';
      }
    }

    // æ›´æ–°é…ç½®
    function updateConfig() {
      const newRate = Math.random();
      monitor.setSampleRate(newRate);
      monitor.setErrorSampleRate(newRate);
      log('info', 'âš™ï¸ é‡‡æ ·ç‡å·²æ›´æ–°', {
        sampleRate: (newRate * 100).toFixed(1) + '%'
      });
    }

    // è®¾ç½®ç”¨æˆ·ä¿¡æ¯
    function setUserInfo() {
      monitor.setUser({
        id: 'user-' + Date.now(),
        username: 'test-user',
        email: 'test@example.com',
        role: 'tester'
      });
      log('info', 'ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯å·²è®¾ç½®');
    }

    // æµ‹è¯•è¿‡æ»¤
    function testFiltering() {
      log('info', 'ğŸ§ª æµ‹è¯•é”™è¯¯è¿‡æ»¤...');

      // è¿™ä¸ªé”™è¯¯åº”è¯¥è¢«è¿‡æ»¤æ‰
      monitor.captureMessage('Test ignored error - should be filtered', 'warn');

      // è¿™ä¸ªé”™è¯¯ä¸åº”è¯¥è¢«è¿‡æ»¤
      monitor.captureMessage('This error should NOT be filtered', 'error');

      log('info', 'è¿‡æ»¤æµ‹è¯•å®Œæˆ', {
        note: 'ä»¥"Test ignored"å¼€å¤´çš„é”™è¯¯åº”è¯¥è¢«è¿‡æ»¤'
      });
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.addEventListener('DOMContentLoaded', () => {
      initSDK();
    });

    // ç›‘å¬ç½‘ç»œçŠ¶æ€å˜åŒ–
    window.addEventListener('online', () => {
      log('info', 'ğŸŒ ç½‘ç»œå·²è¿æ¥ - ç¦»çº¿ç¼“å­˜å°†å¼€å§‹ä¸ŠæŠ¥');
    });

    window.addEventListener('offline', () => {
      log('warn', 'ğŸ“¡ ç½‘ç»œå·²æ–­å¼€ - é”™è¯¯å°†è¢«ç¼“å­˜');
    });
  </script>
</body>
</html>
